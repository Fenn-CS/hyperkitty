{% extends "base.html" %}
{% load url from future %}
{% load i18n %}
{% load hk_generic %}


{% block title %}
{% trans 'Available lists' %} - {{ app_name|title }}
{% endblock %}

{% block content %}

<div class="row-fluid all-lists">

<div class="span2 lists-menu">
    <h2>{% trans 'Lists' %}</h2>
    <ul>
        <li><a href="{% url 'root' %}">All</a></li>
        <li><a href="{% url 'root' %}?sort=active">Most active</a></li>
        <li><a href="{% url 'root' %}?sort=popular">Most popular</a></li>
    </ul>
</div>

<div class="span10">

<h1>{% trans 'Available lists' %}</h1>

{% if all_lists %}
<table class="lists table">
    <thead>
        <tr><th>List</th><th>Description</th><th>Activity in the past 30 days</th></tr>
    </thead>
    <tbody>
{% for mlist in all_lists %}
        <tr
           {% if mlist.is_private %}
           class="private"
           {% elif mlist.recent_threads_count == 0 %}
           class="inactive"
           {% endif %}
           >
            <td>
                <a href="{% url 'list_overview' mlist_fqdn=mlist.name %}"
                   class="list-name">
                    {% if mlist.display_name %}
                        {{ mlist.display_name }}
                    {% else %}
                        {{ mlist.name|until:"@" }}
                    {% endif %}
                </a>
               {% if mlist.is_private %}
               <span class="list-tags">private</span>
               {% elif mlist.recent_threads_count == 0 %}
               <span class="list-tags">inactive</span>
               {% endif %}
                <br />
                <a href="{% url 'list_overview' mlist_fqdn=mlist.name %}"
                   class="list-address">
                    {{ mlist.name }}
                </a>
            </td>
            <td class="list-description"></td>
            <td class="activity">
                <div class="chart" data-chart-values="{{ mlist.evolution|to_json }}"></div>
                <ul class="list-stats">
                    <li><span class="participant">
                        {% if mlist.can_view %}
                        {{ mlist.recent_participants_count }}
                        {% else %}
                        ...
                        {% endif %}
                        participants</span></li>
                    <li><span class="discussion">
                        {% if mlist.can_view %}
                        {{ mlist.recent_threads_count }}
                        {% else %}
                        ...
                        {% endif %}
                        discussions</span></li>
                </ul>
            </td>
        </tr>
{% endfor %}
    </tbody>
</table>
{% else %}
<p>No archived list yet.</p>
{% endif %}

</div> <!-- right column -->

</div>

<img id="logo" alt="HyperKitty" src="{{STATIC_URL}}hyperkitty/img/logo.png" />

{% endblock %}

{% block additionaljs %}

<script>
    $(function() {
        $("div.chart").each(function() {
            chart($(this).get(0),
                  $.parseJSON($(this).attr("data-chart-values")),
                  {height: 30});
        });
    });
</script>

{% endblock %}
